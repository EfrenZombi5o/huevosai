<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AI Assistant with Voice & Code Typing + Chat Delete</title>

  <!-- Google Fonts: Fira Code for code blocks -->
  <link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet" />

  <!-- Highlight.js CSS for syntax highlighting -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css"
  />

  <!-- Your custom CSS -->
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <!-- Sidebar toggle button -->
  <button id="sidebarToggle" aria-label="Toggle sidebar">‚ò∞</button>

  <!-- Login Modal -->
  <div id="loginModal" class="active" aria-modal="true" role="dialog" aria-labelledby="loginTitle" tabindex="-1">
    <div>
      <h2 id="loginTitle">Login or Sign Up</h2>
      <input type="email" id="emailInput" placeholder="Email" autocomplete="email" />
      <input type="password" id="passwordInput" placeholder="Password" autocomplete="current-password" />
      <button id="loginBtn">Login</button>
      <button id="signupBtn">Sign Up</button>
      <button id="googleSignInBtn">Sign in with Google</button>
      <div id="loginError" aria-live="polite"></div>
    </div>
  </div>

  <!-- Mic Permission Prompt -->
  <div id="micPermissionPrompt" role="alertdialog" aria-modal="true" aria-labelledby="micPromptText" tabindex="-1">
    <div>
      <p id="micPromptText">Allow microphone access to use voice input?</p>
      <button id="allowMicBtn">Allow</button>
      <button id="denyMicBtn">Deny</button>
    </div>
  </div>

  <div id="sidebar" class="">
    <div id="chatListHeader">Chats</div>
    <ul id="chatList" role="list" aria-label="Chat list">
      <!-- Chat items will be dynamically generated -->
    </ul>
    <form id="newChatForm" aria-label="Create new chat">
      <input type="text" id="newChatName" placeholder="New chat name" autocomplete="off" required />
      <button type="submit" id="createChatBtn">Create Chat</button>
    </form>
  </div>

  <div id="main">
    <div id="chat" aria-live="polite" aria-label="Chat messages" role="log">
      <!-- Chat messages will appear here -->
    </div>
    <div id="status" aria-live="assertive" role="status"></div>
    <div id="input-area">
      <textarea id="prompt" rows="2" placeholder="Type your message..." autocomplete="off" aria-label="Message input"></textarea>
      <button id="voiceInputBtn" title="Voice Input" aria-label="Voice Input">üé§</button>
      <button id="sendBtn" title="Send Message" aria-label="Send Message">‚û°Ô∏è</button>
    </div>
    <div id="controls">
      <select id="modelSelect" title="Select AI Model" aria-label="Select AI Model">
        <optgroup label="DeepSeek Models">
          <option value="deepseek-chat">DeepSeek Chat (DeepSeek V3)</option>
          <option value="deepseek-reasoner">DeepSeek Reasoner (DeepSeek R1)</option>
        </optgroup>
        <optgroup label="Gemini Models">
          <option value="google/gemini-2.5-pro-exp-03-25:free">Gemini 2.5 Pro</option>
          <option value="google/gemini-2.0-flash-lite-001">Gemini 2.0 Flash Lite</option>
          <option value="google/gemini-flash-1.5-8b">Gemini 1.5 Flash</option>
        </optgroup>
        <optgroup label="OpenAI-Compatible Models">
          <option value="gpt-4o">GPT-4o</option>
          <option value="gpt-4.1">GPT-4.1</option>
          <option value="o3-mini">o3-mini</option>
          <option value="o1-mini">o1-mini</option>
          <option value="gpt-4.5-preview">GPT-4.5 Preview</option>
        </optgroup>
      </select>
      <button id="generateImageBtn" title="Generate Image" aria-label="Generate Image">üñºÔ∏è</button>
      <button id="voiceToggle" title="Toggle Assistant Voice" aria-label="Toggle Assistant Voice">üîä</button>
      <button id="darkModeToggle" title="Toggle Dark Mode" aria-label="Toggle Dark Mode">üåô</button>
    </div>
  </div>

  <!-- Highlight.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>

  <!-- Your Firebase and app scripts should be imported here -->
  <!-- Example: <script type="module" src="./js/app.js"></script> -->

  <script>
    // Sidebar toggle button logic for mobile
    const sidebarToggle = document.getElementById('sidebarToggle');
    const sidebar = document.getElementById('sidebar');

    sidebarToggle.addEventListener('click', () => {
      sidebar.classList.toggle('collapsed');
    });

    // Close sidebar when clicking outside on mobile
    document.addEventListener('click', (e) => {
      if (window.innerWidth <= 768) {
        if (!sidebar.contains(e.target) && !sidebarToggle.contains(e.target)) {
          sidebar.classList.add('collapsed');
        }
      }
    });

    // Initially collapse sidebar on mobile
    function checkWidth() {
      if (window.innerWidth <= 768) {
        sidebar.classList.add('collapsed');
      } else {
        sidebar.classList.remove('collapsed');
      }
    }
    window.addEventListener('resize', checkWidth);
    window.addEventListener('load', checkWidth);

    // Dark mode toggle example (you can expand this)
    const darkModeToggle = document.getElementById('darkModeToggle');
    darkModeToggle.addEventListener('click', () => {
      document.body.classList.toggle('dark');
      sidebar.classList.toggle('dark');
      document.getElementById('newChatForm').classList.toggle('dark');
      document.querySelectorAll('#chatList li').forEach(li => li.classList.toggle('dark'));
      if (document.body.classList.contains('dark')) {
        darkModeToggle.textContent = "‚òÄÔ∏è";
        localStorage.setItem('darkMode', 'true');
      } else {
        darkModeToggle.textContent = "üåô";
        localStorage.setItem('darkMode', 'false');
      }
    });

    // Load dark mode preference on page load
    window.addEventListener('DOMContentLoaded', () => {
      if (localStorage.getItem('darkMode') === 'true') {
        document.body.classList.add('dark');
        sidebar.classList.add('dark');
        document.getElementById('newChatForm').classList.add('dark');
        document.querySelectorAll('#chatList li').forEach(li => li.classList.add('dark'));
        darkModeToggle.textContent = "‚òÄÔ∏è";
      } else {
        darkModeToggle.textContent = "üåô";
      }
    });

    // Initialize highlight.js (for code blocks)
    document.addEventListener('DOMContentLoaded', () => {
      if (window.hljs) {
        document.querySelectorAll('pre code').forEach((block) => {
          hljs.highlightElement(block);
        });
      }
    });

    // TODO: Add your existing app logic here (chat loading, sending, auth, voice, etc.)
  </script>
</body>
</html>
